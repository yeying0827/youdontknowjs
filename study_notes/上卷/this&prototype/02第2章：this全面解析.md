## ç¬¬2ç«  thiså…¨é¢è§£æ

æ¯ä¸ªå‡½æ•°çš„thisæ˜¯åœ¨è°ƒç”¨æ—¶è¢«ç»‘å®šçš„ï¼Œå®Œå…¨å–å†³äºå‡½æ•°çš„è°ƒç”¨ä½ç½®ï¼ˆä¹Ÿå°±æ˜¯å‡½æ•°çš„è°ƒç”¨æ–¹æ³•ï¼‰



### 2.1 è°ƒç”¨ä½ç½®

å‡½æ•°åœ¨ä»£ç ä¸­è¢«è°ƒç”¨çš„ä½ç½®ï¼ˆè€Œä¸æ˜¯å£°æ˜çš„ä½ç½®ï¼‰=> thisåˆ°åº•å¼•ç”¨çš„æ˜¯ä»€ä¹ˆï¼Ÿ

æŸäº›ç¼–ç¨‹æ¨¡å¼å¯èƒ½ä¼š**éšè—**çœŸæ­£çš„è°ƒç”¨ä½ç½®ã€‚

æœ€é‡è¦çš„æ˜¯è¦åˆ†æ**è°ƒç”¨æ ˆ**ï¼ˆå°±æ˜¯ä¸ºäº†åˆ°è¾¾å½“å‰æ‰§è¡Œä½ç½®æ‰€è°ƒç”¨çš„æ‰€æœ‰å‡½æ•°ï¼‰ã€‚è°ƒç”¨ä½ç½®å°±åœ¨å½“å‰**æ­£åœ¨æ‰§è¡Œ**çš„å‡½æ•°çš„**å‰**ä¸€ä¸ªè°ƒç”¨ä¸­ã€‚

ğŸŒ°ï¼š

```javascript
function baz() {
  // å½“å‰è°ƒç”¨æ ˆï¼šbaz
  // å½“å‰è°ƒç”¨ä½ç½®æ˜¯å…¨å±€ä½œç”¨åŸŸ
  console.log( "baz" );
  bar(); // barçš„è°ƒç”¨ä½ç½®
}

function bar() {
  // å½“å‰è°ƒç”¨æ ˆï¼šbaz -> bar
  // å½“å‰è°ƒç”¨ä½ç½®æ˜¯åœ¨bazä¸­
  console.log( "bar" );
  foo(); // fooçš„è°ƒç”¨ä½ç½®
}

function foo() {
  // å½“å‰è°ƒç”¨æ ˆï¼šbaz -> bar -> foo
  // å½“å‰è°ƒç”¨ä½ç½®æ˜¯åœ¨barä¸­
  console.log( "foo" );
}

baz(); // bazçš„è°ƒç”¨ä½ç½®
```

å¯ä»¥æŠŠè°ƒç”¨æ ˆæƒ³è±¡æˆä¸€ä¸ªå‡½æ•°è°ƒç”¨é“¾ï¼Œå¦‚ä¸Šä¾‹æ³¨é‡Šï¼›å¦ä¸€ä¸ªæŸ¥çœ‹è°ƒç”¨æ ˆçš„æ–¹æ³•æ˜¯ï¼Œä½¿ç”¨æµè§ˆå™¨çš„è°ƒè¯•å·¥å…·ï¼ˆè®¾ç½®æ–­ç‚¹ï¼‰ï¼Œè¿è¡Œæš‚åœæ—¶ï¼Œä¼šå±•ç¤ºå½“å‰ä½ç½®çš„å‡½æ•°è°ƒç”¨åˆ—è¡¨ï¼Œè¿™å°±æ˜¯è°ƒç”¨æ ˆã€‚



### 2.2 ç»‘å®šè§„åˆ™

è°ƒç”¨ä½ç½®**å¦‚ä½•**å†³å®šthisçš„ç»‘å®šå¯¹è±¡ã€‚

åˆ¤æ–­åº”ç”¨ä¸‹é¢å››æ¡è§„åˆ™ä¸­çš„å“ªä¸€æ¡ã€‚é»˜è®¤ç»‘å®šã€éšå¼ç»‘å®šã€æ˜¾å¼ç»‘å®šã€newç»‘å®š

* **é»˜è®¤ç»‘å®š**

  æœ€å¸¸ç”¨çš„å‡½æ•°è°ƒç”¨ç±»å‹ï¼šç‹¬ç«‹å‡½æ•°è°ƒç”¨ã€‚æ— æ³•åº”ç”¨å…¶ä»–è§„åˆ™æ—¶çš„é»˜è®¤è§„åˆ™ã€‚

  ğŸŒ°ï¼š

  ```javascript
  function foo() {
    console.log( this.a );
  }
  var a = 2;
  foo(); // 2
  
  (function() {
    "use strict";
    
    foo();
  })();
  ```

  æœ¬ä¾‹ä¸­ï¼Œå‡½æ•°è°ƒç”¨æ—¶åº”ç”¨äº†thisçš„é»˜è®¤ç»‘å®šï¼Œå› æ­¤thisæŒ‡å‘å…¨å±€å¯¹è±¡ã€‚

  åˆ†æï¼šä»£ç ä¸­`foo()`æ˜¯ç›´æ¥ä½¿ç”¨**ä¸å¸¦ä»»ä½•ä¿®é¥°çš„**å‡½æ•°å¼•ç”¨è¿›è¡Œè°ƒç”¨çš„ï¼Œå› æ­¤åªèƒ½ä½¿ç”¨é»˜è®¤ç»‘å®šã€‚

  å¦‚ä½¿ç”¨ä¸¥æ ¼æ¨¡å¼(strict mode)ï¼Œåˆ™ä¸èƒ½å°†å…¨å±€å¯¹è±¡ç”¨äºé»˜è®¤ç»‘å®šï¼Œå› æ­¤`this`ä¼šç»‘å®šåˆ°**undefined**ã€‚

  ğŸŒ°ï¼š

  ```javascript
  function foo() {
    "use strict";
    
    console.log( this.a );
  }
  var a = 2;
  foo(); //  TypeError: Cannot read property 'a' of undefined
  ```

  æ³¨ï¼šåªæœ‰`foo()`è¿è¡Œåœ¨éstrict modeä¸‹æ—¶ï¼Œé»˜è®¤ç»‘å®šæ‰èƒ½ç»‘å®šåˆ°å…¨å±€å¯¹è±¡ï¼›åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹**è°ƒç”¨**`foo()`åˆ™ä¸å½±å“é»˜è®¤ç»‘å®šã€‚

  æ³¨ï¼šé€šå¸¸æ¥è¯´ä¸åº”è¯¥æ··ç”¨strictæ¨¡å¼å’Œéstrictæ¨¡å¼ï¼›ç¬¬ä¸‰æ–¹åº“å¯èƒ½ä¸¥æ ¼ç¨‹åº¦ä¸ä¸€æ ·ï¼Œéœ€è¦æ³¨æ„å…¼å®¹ç»†èŠ‚ã€‚

* **éšå¼ç»‘å®š**

  è°ƒç”¨ä½ç½®**æ˜¯å¦**æœ‰ä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œæˆ–è€…è¯´æ˜¯å¦**è¢«**æŸä¸ªå¯¹è±¡æ‹¥æœ‰æˆ–è€…åŒ…å«ã€‚

  ğŸŒ°ï¼š

  ```javascript
  function foo() {
    console.log( this.a );
  }
  var obj = {
    a: 2,
    foo: foo
  };
  obj.foo(); // 2 
  ```

  é¦–å…ˆï¼Œéœ€è¦æ³¨æ„`foo()`çš„å£°æ˜æ–¹å¼ï¼ŒåŠå…¶ä¹‹åæ˜¯**å¦‚ä½•**è¢«å½“ä½œ**å¼•ç”¨å±æ€§**æ·»åŠ åˆ°objä¸­çš„ã€‚

  ä½†æ— è®ºæ˜¯ç›´æ¥åœ¨objä¸­å®šä¹‰è¿˜æ˜¯å…ˆå®šä¹‰å†æ·»åŠ ä¸ºå¼•ç”¨å±æ€§ï¼Œè¿™ä¸ªå‡½æ•°**ä¸¥æ ¼æ¥è¯´éƒ½ä¸å±äºobjå¯¹è±¡**ã€‚

  ç„¶è€Œè°ƒç”¨ä½ç½®ä¼š**ä½¿ç”¨objä¸Šä¸‹æ–‡**æ¥å¼•ç”¨å‡½æ•° => å¯ä»¥è¯´å‡½æ•°**è¢«è°ƒç”¨æ—¶**objå¯¹è±¡â€æ‹¥æœ‰â€œæˆ–è€…â€åŒ…å«â€œå®ƒã€‚=> å½“`foo()`è¢«è°ƒç”¨æ—¶ï¼Œå®ƒçš„å‰é¢åŠ ä¸Šäº†å¯¹objçš„å¼•ç”¨

  å½“å‡½æ•°å¼•ç”¨æœ‰ä¸Šä¸‹æ–‡å¯¹è±¡æ—¶ï¼Œ**éšå¼ç»‘å®š**è§„åˆ™ä¼šæŠŠå‡½æ•°è°ƒç”¨ä¸­çš„thisç»‘å®šåˆ°è¿™ä¸ªä¸Šä¸‹æ–‡å¯¹è±¡ã€‚=> `this.a`å’Œ`obj.a`æ˜¯ä¸€æ ·çš„

  å¯¹è±¡å±æ€§å¼•ç”¨é“¾ä¸­åªæœ‰**ä¸Šä¸€å±‚æˆ–è€…è¯´æœ€åä¸€å±‚**åœ¨è°ƒç”¨ä½ç½®ä¸­èµ·ä½œç”¨ã€‚ğŸŒ°ï¼š

  ```javascript
  function foo() {
    console.log( this.a );
  }
  
  var obj2 = {
    a: 42,
    foo: foo
  };
  
  var obj1 = {
    a: 2,
    obj2: obj2
  };
  
  obj1.obj2.foo(); // 42
  ```

  **\**å­˜åœ¨é—®é¢˜ï¼šéšå¼ä¸¢å¤±**

  è¢«éšå¼ç»‘å®šçš„å‡½æ•°ä¼š**ä¸¢å¤±**ç»‘å®šå¯¹è±¡ï¼Œå³ä¼šåº”ç”¨é»˜è®¤ç»‘å®šã€‚

  1. å¼•ç”¨å‡½æ•°æœ¬èº«

     ```javascript
     function foo() {
       console.log( this.a );
     }
     var obj = {
       a: 2,
       foo: foo
     };
     var bar = obj.foo; // å‡½æ•°åˆ«åï¼
     var a = "oops, global";
     bar(); // "oops, global"
     ```

     è™½ç„¶baræ˜¯obj.fooçš„ä¸€ä¸ªå¼•ç”¨ï¼Œä½†å®é™…ä¸Šï¼Œå®ƒå¼•ç”¨çš„æ˜¯`foo`å‡½æ•°**æœ¬èº«**=>æ­¤æ—¶`bar()`æ˜¯ä¸€ä¸ªä¸å¸¦ä»»ä½•ä¿®é¥°çš„å‡½æ•°è°ƒç”¨ï¼Œå› æ­¤åº”ç”¨äº†é»˜è®¤ç»‘å®šã€‚

  2. ä¼ å…¥å›è°ƒå‡½æ•°æ—¶

     ```javascript
     function foo() {
       console.log( this.a );
     }
     function doFoo(fn) {
       fn(); // <-- è°ƒç”¨ä½ç½®
     }
     var obj = {
       a: 2,
       foo: foo
     };
     var a = "oops, global";
     doFoo( obj.foo ); // "oops, global"
     ```

     å‚æ•°ä¼ é€’å°±æ˜¯ä¸€ç§éšå¼èµ‹å€¼

     **è°ƒç”¨å›è°ƒå‡½æ•°çš„å‡½æ•°å¯èƒ½ä¼šä¿®æ”¹this**: ç¬¬ä¸‰æ–¹åº“ã€‚=> æˆ‘ä»¬æ— æ³•æ§åˆ¶å›è°ƒå‡½æ•°çš„æ‰§è¡Œæ–¹å¼ï¼Œå› æ­¤å°±**æ²¡æœ‰åŠæ³•**æ§åˆ¶è°ƒç”¨ä½ç½®ä»¥å¾—åˆ°æœŸæœ›çš„ç»‘å®šã€‚

* **æ˜¾å¼ç»‘å®š**

  ä¸æƒ³åœ¨å¯¹è±¡å†…éƒ¨åŒ…å«å‡½æ•°å¼•ç”¨ï¼Œè€Œæƒ³åœ¨æŸä¸ªå¯¹è±¡ä¸Šå¼ºåˆ¶è°ƒç”¨å‡½æ•°

  => å¯ä»¥ä½¿ç”¨å‡½æ•°çš„`call(...)`å’Œ`apply(...)`æ–¹æ³•ï¼ˆç»å¤§å¤šæ•°å‡½æ•°å¯è¡Œï¼‰

  => **å¦‚ä½•å·¥ä½œï¼Ÿ**å®ƒä»¬çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæ˜¯ç»™`this`å‡†å¤‡çš„ï¼Œæ¥ç€åœ¨è°ƒç”¨å‡½æ•°æ—¶å°†å…¶ç»‘å®šåˆ°`this` -> å³æ˜¾å¼ç»‘å®š

  å¦‚æœä½ ä¼ å…¥äº†ä¸€ä¸ªåŸå§‹å€¼ï¼ˆå­—ç¬¦ä¸²ç±»å‹ã€å¸ƒå°”ç±»å‹æˆ–è€…æ•°å­—ç±»å‹ï¼‰æ¥å½“ä½œ`this`çš„ç»‘å®šå¯¹è±¡ï¼Œè¿™ä¸ªåŸå§‹å€¼ä¼šè¢«è½¬æ¢æˆå®ƒçš„å¯¹è±¡å½¢å¼ï¼ˆå³`new String(...)`ã€`new Boolean(...)`æˆ–è€…`new Number(...)`ï¼‰ã€‚è¿™é€šå¸¸è¢«ç§°ä¸ºâ€œè£…ç®±â€ã€‚

  æ˜¾å¼ç»‘å®šä»**æ— æ³•è§£å†³**ä¸¢å¤±ç»‘å®šé—®é¢˜ã€‚ï¼ˆç«‹å³æ‰§è¡Œï¼Œæ— æ³•ä¼ é€’ã€å¼•ç”¨ï¼‰**å¯ç”¨æ–¹æ¡ˆï¼š**

  1. ç¡¬ç»‘å®š

     æ˜¾å¼ç»‘å®šçš„ä¸€ä¸ªå˜ç§ã€‚ç¤ºä¾‹ï¼š

     ```javascript
     function foo () {
       console.log( this.a );
     }
     var obj = {
       a: 2
     };
     var bar = function () {
       foo.call( obj );
     }
     bar(); // 2
     setTimeout( bar, 100 ); // 2
     bar.call( window ); // 2
     ```

     åˆ†æï¼šåˆ›å»ºäº†å‡½æ•°`bar()`å¹¶åœ¨å®ƒçš„å†…éƒ¨æ‰‹åŠ¨è°ƒç”¨äº†`foo.call( obj )`ï¼Œå› æ­¤å¼ºåˆ¶æŠŠ`foo`çš„**`this`**ç»‘å®šåˆ°äº†`obj`ã€‚=> æ— è®ºä¹‹åå¦‚ä½•è°ƒç”¨å‡½æ•°`bar`ï¼Œå®ƒæ€»ä¼šæ‰‹åŠ¨åœ¨`obj`ä¸Šè°ƒç”¨`foo`ã€‚

     è¿™æ˜¯ä¸€ç§æ˜¾å¼çš„å¼ºåˆ¶ç»‘å®šï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º**ç¡¬ç»‘å®š**ã€‚

     **å…¸å‹åº”ç”¨åœºæ™¯ï¼š**åˆ›å»ºä¸€ä¸ªåŒ…è£¹å‡½æ•°ï¼Œè´Ÿè´£æ¥æ”¶å‚æ•°å¹¶è¿”å›å€¼ï¼š

     å½¢å¦‚ä¸Šä¾‹çš„`bar`

     ```javascript
     var bar = function () {
       return foo.apply( obj, arguments );
     }
     ```

     å¦ä¸€ç§ä½¿ç”¨æ–¹æ³•ï¼šæ˜¯åˆ›å»ºä¸€ä¸ªå¯ä»¥é‡å¤ä½¿ç”¨çš„è¾…åŠ©å‡½æ•°ï¼š

     ```javascript
     function bind(fn, obj) { // ç®€å•çš„è¾…åŠ©ç»‘å®šå‡½æ•°
       return function () {
         return fn.apply( obj, arguments );
       }
     }
     
     var bar = bind( foo, obj );
     ```

     ç”±äºç¡¬ç»‘å®šæ˜¯ä¸€ç§éå¸¸å¸¸ç”¨çš„æ¨¡å¼ => æ‰€ä»¥ES5æä¾›äº†å†…ç½®çš„æ–¹æ³•`Function.prototype.bind`ï¼Œå®ƒçš„ç”¨æ³•ç¤ºä¾‹å¦‚ä¸‹ï¼š

     ```javascript
     var bar = foo.bind( obj );
     ```

     `bind(...)`ä¼šè¿”å›ä¸€ä¸ªç¡¬ç¼–ç çš„***æ–°***å‡½æ•°ï¼Œå®ƒä¼šæŠŠä½ æŒ‡å®šçš„å‚æ•°è®¾ç½®ä¸º**`this`**çš„ä¸Šä¸‹æ–‡å¹¶è°ƒç”¨åŸå§‹å‡½æ•°ã€‚

  2. APIè°ƒç”¨çš„â€œä¸Šä¸‹æ–‡â€

     ç¬¬ä¸‰æ–¹åº“çš„è®¸å¤šå‡½æ•°ï¼Œä»¥åŠJavaScriptè¯­è¨€å’Œå®¿ä¸»ç¯å¢ƒä¸­è®¸å¤šæ–°çš„å†…ç½®å‡½æ•°ï¼Œéƒ½æä¾›äº†ä¸€ä¸ªå¯é€‰çš„å‚æ•°ï¼Œé€šå¸¸è¢«ç§°ä¸ºâ€œä¸Šä¸‹æ–‡â€ï¼ˆcontextï¼‰ï¼Œå…¶ä½œç”¨å’Œ`bind`ä¸€æ ·ï¼Œç¡®ä¿ä½ çš„å›è°ƒå‡½æ•°ä½¿ç”¨æŒ‡å®šçš„`this`ã€‚

     ğŸŒ°ï¼š

     ```javascript
     function foo(el) {
       console.log( el, this.id );
     }
     var obj = {
       id: 'awesome'
     };
     [1, 2, 3].forEach( foo, obj ); // 1 "awesome" 2 "awesome" 3 "awesome"
     [1, 2, 3].forEach( el => {
       console.log( el );
     } );
     ```

     å®é™…ä¸Šè¿™äº›å‡½æ•°å°±æ˜¯é€šè¿‡`call(...)`æˆ–è€…`apply(...)`å®ç°äº†æ˜¾å¼ç»‘å®šã€‚

* **newç»‘å®š**

  **å‰ç½®çŸ¥è¯†**ï¼š

  åœ¨ä¼ ç»Ÿçš„é¢å‘ç±»çš„è¯­è¨€ä¸­ï¼Œâ€œæ„é€ å‡½æ•°â€æ˜¯**ç±»ä¸­**çš„ä¸€äº›ç‰¹æ®Šæ–¹æ³•ï¼Œä½¿ç”¨`new`åˆå§‹åŒ–ç±»æ—¶ä¼šè°ƒç”¨ç±»ä¸­çš„æ„é€ å‡½æ•°ã€‚JavaScriptä¹Ÿæœ‰ä¸€ä¸ª`new`æ“ä½œç¬¦ï¼Œä½¿ç”¨æ–¹æ³•çœ‹èµ·æ¥ä¹Ÿç±»ä¼¼ï¼Œç„¶è€Œä¸¤è€…çš„`new`æœºåˆ¶å®Œå…¨ä¸åŒã€‚

  åœ¨JavaScriptä¸­ï¼Œæ„é€ å‡½æ•°åªæ˜¯ä¸€äº›ä½¿ç”¨**`new`**æ“ä½œç¬¦æ—¶è¢«è°ƒç”¨çš„å‡½æ•°ï¼Œå®ƒä»¬å¹¶ä¸ä¼šå±äºæŸä¸ªç±»ï¼Œä¹Ÿä¸ä¼šå®ä¾‹åŒ–ä¸€ä¸ªç±»ã€‚å®é™…ä¸Šï¼Œå®ƒä»¬ç”šè‡³éƒ½ä¸èƒ½è¯´æ˜¯ä¸€ç§ç‰¹æ®Šçš„å‡½æ•°ç±»å‹ï¼Œå®ƒä»¬åªæ˜¯è¢«`new`æ“ä½œç¬¦è°ƒç”¨çš„**æ™®é€š**å‡½æ•°è€Œå·²ã€‚

  åŒ…æ‹¬å†…ç½®å¯¹è±¡å‡½æ•°ï¼ˆå¦‚`Number(...)`ï¼‰åœ¨å†…çš„æ‰€æœ‰å‡½æ•°éƒ½å¯ä»¥ç”¨`new`æ¥è°ƒç”¨ï¼Œè¿™ç§å‡½æ•°è°ƒç”¨è¢«ç§°ä¸º**æ„é€ å‡½æ•°è°ƒç”¨**ã€‚=> å®é™…ä¸Šå¹¶ä¸å­˜åœ¨æ‰€è°“çš„â€œæ„é€ å‡½æ•°â€ï¼Œåªæœ‰å¯¹äºå‡½æ•°çš„â€œ**æ„é€ è°ƒç”¨**â€ã€‚

  ä½¿ç”¨`new`æ¥è°ƒç”¨å‡½æ•°ï¼Œæˆ–è€…è¯´å‘ç”Ÿæ„é€ å‡½æ•°è°ƒç”¨æ—¶ï¼Œä¼šè‡ªåŠ¨æ‰§è¡Œä¸‹é¢çš„æ“ä½œï¼š

  1. åˆ›å»ºï¼ˆæˆ–è€…è¯´æ„é€ ï¼‰ä¸€ä¸ªå…¨æ–°çš„å¯¹è±¡ï¼›
  2. è¿™ä¸ªæ–°å¯¹è±¡ä¼šè¢«æ‰§è¡Œ[[Prototype]]è¿æ¥ï¼›
  3. è¿™ä¸ªæ–°å¯¹è±¡ä¼š**ç»‘å®šåˆ°**å‡½æ•°è°ƒç”¨çš„`this`ï¼›
  4. å¦‚æœå‡½æ•°æ²¡æœ‰è¿”å›å…¶ä»–å¯¹è±¡ï¼Œé‚£ä¹ˆ`new`è¡¨è¾¾å¼ä¸­çš„å‡½æ•°è°ƒç”¨ä¼š**è‡ªåŠ¨è¿”å›**è¿™ä¸ªæ–°å¯¹è±¡ã€‚



### 2.3 ä¼˜å…ˆçº§

å¦‚æœæŸä¸ªè°ƒç”¨ä½ç½®å¯ä»¥åº”ç”¨å¤šæ¡è§„åˆ™è¯¥æ€ä¹ˆåŠï¼Ÿ

é»˜è®¤ç»‘å®šçš„ä¼˜å…ˆçº§æ˜¯å››æ¡è§„åˆ™ä¸­æœ€ä½çš„ã€‚

1.éšå¼Vs.æ˜¾å¼ï¼Œ**æ˜¾å¼ä¼˜å…ˆçº§é«˜äºéšå¼**ã€‚ğŸŒ°ï¼š

```javascript
function foo() {
  console.log( this.a );
}
var obj1 = {
  a: 2,
  foo: foo
};
var obj2 = {
  a: 3,
  foo: foo
};
obj1.foo(); // 2
obj2.foo(); // 3

obj1.foo.call( obj2 ); // 3
obj2.foo.call( obj1 ); // 2
```

2.newVs.éšå¼ï¼Œ**newä¼˜å…ˆçº§é«˜äºéšå¼**ã€‚ğŸŒ°ï¼š

```javascript
function foo(something) {
  this.a = something;
}

var obj1 = {
  foo: foo
};
var obj2 = {};

// éšå¼
obj1.foo( 2 );
console.log( obj1.a ); // 2

// æ˜¾å¼
obj1.foo.call( obj2, 3 );
console.log( obj2.a ); // 3

// new
var bar = new obj1.foo( 4 ); // thisæŒ‡å‘æ–°åˆ›å»ºçš„å¯¹è±¡
console.log( obj1.a ); // 2
console.log( bar.a ); // 4
```

3.newVs.æ˜¾å¼

newå’Œcall/applyæ— æ³•ä¸€èµ·ä½¿ç”¨ï¼Œå› æ­¤æ— æ³•é€šè¿‡`new foo.call( obj1 )`æ¥ç›´æ¥è¿›è¡Œæµ‹è¯•ã€‚=> é€šè¿‡**ç¡¬ç»‘å®š**æ¥æµ‹è¯•

`Function.prototype.bind`åˆ›å»ºå¹¶è¿”å›ä¸€ä¸ªæ–°çš„åŒ…è£…å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ä¼šå¿½ç•¥å®ƒå½“å‰çš„**`this`**ç»‘å®šï¼ˆæ— è®ºç»‘å®šçš„å¯¹è±¡æ˜¯ä»€ä¹ˆï¼‰ï¼Œå¹¶æŠŠæˆ‘ä»¬æä¾›çš„å¯¹è±¡ç»‘å®šåˆ°`this`ä¸Šã€‚=>**çœ‹ä¸Šå»**ç¡¬ç»‘å®šï¼ˆæ˜¾å¼ç»‘å®šçš„ä¸€ç§ï¼‰ä¼¼ä¹æ¯”newç»‘å®šçš„ä¼˜å…ˆçº§æ›´é«˜ã€‚

ğŸŒ°ï¼š

```javascript
function foo(something) {
  this.a = something;
}
var obj1 = {};

var bar = foo.bind( obj1 ); // ä¸€ä¸ªæ–°çš„åŒ…è£…å‡½æ•°ï¼ŒæŠŠthisç»‘å®šåˆ°obj1
bar( 2 );
console.log( obj1.a ); // 2

var baz = new bar( 3 );
console.log( obj1.a ); // 2
console.log( baz.a ); // 3
```

`bar`è¢«ç¡¬ç»‘å®šåˆ°`obj1`ä¸Šï¼Œä½†`new bar(3)`å¹¶æ²¡æœ‰æŠŠ`obj1.a`ä¿®æ”¹ä¸º3ï¼›ç›¸åï¼Œ`new`ä¿®æ”¹äº†ç¡¬ç»‘å®šè°ƒç”¨`bar(...)`ä¸­çš„**`this`**ã€‚

ä½¿ç”¨`new`ç»‘å®šï¼Œå¾—åˆ°äº†ä¸€ä¸ªåå­—ä¸ºbazçš„æ–°å¯¹è±¡ï¼Œå¹¶ä¸”`baz.a`çš„å€¼æ˜¯3ã€‚ï¼ˆè·Ÿé¡ºåºæœ‰å…³ï¼Ÿï¼Ÿthisè¢«è¦†ç›–ï¼Ÿï¼Ÿï¼‰

å›é¡¾â€è£¸â€œè¾…åŠ©å‡½æ•°`bind`ï¼š

```javascript
function bind(fn, obj) { // ç®€å•çš„è¾…åŠ©ç»‘å®šå‡½æ•°
  return function () {
    return fn.apply( obj, arguments );
  }
}
```

**çœ‹èµ·æ¥**åœ¨è¾…åŠ©å‡½æ•°ä¸­`new`æ“ä½œç¬¦çš„è°ƒç”¨æ— æ³•ä¿®æ”¹`this`ç»‘å®šã€‚